<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>WAFO. Description of dat2spec2</title>
  <meta name="keywords" content="dat2spec2">
  <meta name="description" content=" Estimate one-sided spectral density, version 2.">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../index.html">Home</a> &gt;  <a href="../index.html">wafo</a> &gt; <a href="index.html">onedim</a> &gt; dat2spec2.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../index.html"><img alt="<" border="0" src="../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for wafo\onedim&nbsp;<img alt=">" border="0" src="../../right.png"></a></td></tr></table>-->

<h1>dat2spec2
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong> Estimate one-sided spectral density, version 2.</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong> S = dat2spec2(xn,L,g,plotflag,wdef,dT,chopOffHighFreq) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> <a href="dat2spec2.html" class="code" title=" Estimate one-sided spectral density, version 2.  ">DAT2SPEC2</a> Estimate one-sided spectral density, version 2.  
       using a <a href="../../wafo/onedim/private/parzen.html" class="code" title=" returns the N-point Parzen window in a column vector.">Parzen</a> window function on  
       the estimated autocovariance function. 
   
  CALL:  S = <a href="dat2spec2.html" class="code" title=" Estimate one-sided spectral density, version 2.  ">dat2spec2</a>(x,L,g,plotflag,wdef,dT) 
  
          S = A structure containing: 
              S    = spectral density 
              w    = angular frequency 
              tr   = transformation g 
              h    = water depth (default inf) 
              type = 'freq' 
              note = Memorandum string 
              date = Date and time of creation  
              L    = maximum lag size of the window function.  
              Bw   = Bandwidth of the smoothing window which is used  
                     in the estimated spectrum. (rad/sec or Hz) 
              
  
          x =  m column data matrix with sampled times in the first column 
               and values the next columns.     
  
          L = maximum lag size of the window function.  
              If no value is given, the lag size is set to 
              be the lag where the auto correlation is less than  
              2 standard deviations. (maximum 300)  
                           
          g = the transformation assuming that x is a <a href="../../wafo/kdetools/sample.html" class="code" title="  Random sampling of points from a data-set ">sample</a> of a  
              transformed Gaussian process. If g is empty then 
              x  is a <a href="../../wafo/kdetools/sample.html" class="code" title="  Random sampling of points from a data-set ">sample</a> of a Gaussian process (Default) 
  
   plotflag = 1 plots the spectrum, S,  
              2 plot 10log10(S) and 
              3 plots both the above plots 
  
         wdef = 'parzen'   then a <a href="../../wafo/onedim/private/parzen.html" class="code" title=" returns the N-point Parzen window in a column vector.">Parzen</a> window is used (default). 
                'hanning'  then a <a href="../../wafo/onedim/private/hanning.html" class="code" title=" returns the N-point Hanning window in a column vector.">Hanning</a> window is used.  
  
          dT  = sampling interval. Default is dT=x(2,1)-x(1,1) or 1Hz. 
  
   As L decreases the estimate becomes smoother and Bw increases.  
   If we want to resolve peaks in S which is Bf (Hz or rad/sec) apart  
   then Bw &lt; Bf.  
    
  See also   <a href="../../wafo/trgauss/dat2tr.html" class="code" title=" Estimate transformation, g, from data.">dat2tr</a>, <a href="dat2cov.html" class="code" title=" Estimate auto covariance function from data.">dat2cov</a>, <a href="dat2spec.html" class="code" title=" Estimate one-sided spectral density from data.">dat2spec</a></pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
<TABLE BORDER=0>

<TR>
<TD><li><a href="../../wafo/spec/createspec.html" class="code" title=" S=createspec(stype,freqtype)">createspec</a></li></TD>
<TD> Spectrum structure constructor</TD>
</TR>
<TR>
<TD><li><a href="dat2cov.html" class="code" title=" R = dat2cov(xn,varargin)">dat2cov</a></li></TD>
<TD> Estimate auto covariance function from data.</TD>
</TR>
<TR>
<TD><li><a href="../../wafo/trgauss/dat2gaus.html" class="code" title=" xx = dat2gaus(x,g)">dat2gaus</a></li></TD>
<TD> Transforms  x  using the transformation  g.</TD>
</TR>
<TR>
<TD><li><a href="../../wafo/trgauss/dat2tr.html" class="code" title=" [g, test, cmax, irr, g2]= dat2tr(x,def,varargin);">dat2tr</a></li></TD>
<TD> Estimate transformation, g, from data.</TD>
</TR>
<TR>
<TD><li><a href="../../wafo/onedim/private/hanning.html" class="code" title=" w = hanning(n,p)">hanning</a></li></TD>
<TD> returns the N-point Hanning window in a column vector.</TD>
</TR>
<TR>
<TD><li><a href="../../wafo/onedim/private/parzen.html" class="code" title=" [w, be] = parzen(n,fs)">parzen</a></li></TD>
<TD> returns the N-point Parzen window in a column vector.</TD>
</TR>
<TR>
<TD><li><a href="../../wafo/spec/wnormspec.html" class="code" title=" [S,mn4,m0,m2,m4,m1]=wnormspec(spectrum,m0,m2,plotflag)">wnormspec</a></li></TD>
<TD> Normalize a spectral density such that m0=m2=1</TD>
</TR>
<TR>
<TD><li><a href="../../wafo/spec/wspecplot.html" class="code" title=" wspecplot(S,varargin)">wspecplot</a></li></TD>
<TD> Plot a spectral density</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\lang\error.m">error</a></li></TD>
<TD>         Display message and abort function.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\datafun\@logical\fft.bi">fft</a></li></TD>
<TD>           Discrete Fourier transform.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\lang\inputname.m">inputname</a></li></TD>
<TD>     Input argument name.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\strfun\ischar.m">ischar</a></li></TD>
<TD>        True for character array (string).</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\strfun\@char\lower.bi">lower</a></li></TD>
<TD>         Convert string to lowercase.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\datafun\mean.m">mean</a></li></TD>
<TD>          Average or mean value.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\elfun\nextpow2.m">nextpow2</a></li></TD>
<TD>      Next higher power of 2.</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\strfun\num2str.m">num2str</a></li></TD>
<TD>       Convert number to string. (Fast version)</TD>
</TR>
<TR>
<TD><li><a href="" class="code" title="C:\programs\matlab71\toolbox\matlab\strfun\@char\strcmp.bi">strcmp</a></li></TD>
<TD>        Compare strings.</TD>
</TR>
</TABLE>
</ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
<TABLE BORDER=0>

<TR>
<TD><li><a href="../../wafo/papers/tutorcom/Chapter2.html" class="code" title="This is a script file.">Chapter2</a></li></TD>
<TD> % CHAPTER2 Modelling random loads and stochastic waves</TD>
</TR>
<TR>
<TD><li><a href="../../wafo/papers/tutorcom/Chapter3.html" class="code" title="This is a script file.">Chapter3</a></li></TD>
<TD> % CHAPTER3  Demonstrates distributions of wave characteristics</TD>
</TR>
</TABLE>

</ul>
<!-- crossreference -->


<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>001 <span class="keyword">function</span> S = <a name="_sub0" href="#_subfunctions" class="code">dat2spec2</a>(xn,L,g,plotflag,wdef,dT,chopOffHighFreq) 
002 <span class="comment">%DAT2SPEC2 Estimate one-sided spectral density, version 2.  </span>
003 <span class="comment">%      using a Parzen window function on  </span>
004 <span class="comment">%      the estimated autocovariance function. </span>
005 <span class="comment">%  </span>
006 <span class="comment">% CALL:  S = dat2spec2(x,L,g,plotflag,wdef,dT) </span>
007 <span class="comment">% </span>
008 <span class="comment">%         S = A structure containing: </span>
009 <span class="comment">%             S    = spectral density </span>
010 <span class="comment">%             w    = angular frequency </span>
011 <span class="comment">%             tr   = transformation g </span>
012 <span class="comment">%             h    = water depth (default inf) </span>
013 <span class="comment">%             type = 'freq' </span>
014 <span class="comment">%             note = Memorandum string </span>
015 <span class="comment">%             date = Date and time of creation  </span>
016 <span class="comment">%             L    = maximum lag size of the window function.  </span>
017 <span class="comment">%             Bw   = Bandwidth of the smoothing window which is used  </span>
018 <span class="comment">%                    in the estimated spectrum. (rad/sec or Hz) </span>
019 <span class="comment">%             </span>
020 <span class="comment">% </span>
021 <span class="comment">%         x =  m column data matrix with sampled times in the first column </span>
022 <span class="comment">%              and values the next columns.     </span>
023 <span class="comment">% </span>
024 <span class="comment">%         L = maximum lag size of the window function.  </span>
025 <span class="comment">%             If no value is given, the lag size is set to </span>
026 <span class="comment">%             be the lag where the auto correlation is less than  </span>
027 <span class="comment">%             2 standard deviations. (maximum 300)  </span>
028 <span class="comment">%                          </span>
029 <span class="comment">%         g = the transformation assuming that x is a sample of a  </span>
030 <span class="comment">%             transformed Gaussian process. If g is empty then </span>
031 <span class="comment">%             x  is a sample of a Gaussian process (Default) </span>
032 <span class="comment">% </span>
033 <span class="comment">%  plotflag = 1 plots the spectrum, S,  </span>
034 <span class="comment">%             2 plot 10log10(S) and </span>
035 <span class="comment">%             3 plots both the above plots </span>
036 <span class="comment">% </span>
037 <span class="comment">%        wdef = 'parzen'   then a Parzen window is used (default). </span>
038 <span class="comment">%               'hanning'  then a Hanning window is used.  </span>
039 <span class="comment">% </span>
040 <span class="comment">%         dT  = sampling interval. Default is dT=x(2,1)-x(1,1) or 1Hz. </span>
041 <span class="comment">% </span>
042 <span class="comment">%  As L decreases the estimate becomes smoother and Bw increases.  </span>
043 <span class="comment">%  If we want to resolve peaks in S which is Bf (Hz or rad/sec) apart  </span>
044 <span class="comment">%  then Bw &lt; Bf.  </span>
045 <span class="comment">%   </span>
046 <span class="comment">% See also   dat2tr, dat2cov, dat2spec </span>
047  
048 <span class="comment">% May chop off high frequencies in order to  </span>
049 <span class="comment">% get the same irregularity factor in the spectrum as  </span>
050 <span class="comment">% in x. </span>
051  
052  
053 <span class="comment">% References: </span>
054 <span class="comment">% Georg Lindgren and Holger Rootzen (1986) </span>
055 <span class="comment">% &quot;Stationära stokastiska processer&quot;,  pp 173--176. </span>
056 <span class="comment">%  </span>
057 <span class="comment">% Gareth Janacek and Louise Swift (1993) </span>
058 <span class="comment">% &quot;TIME SERIES forecasting, simulation, applications&quot;, </span>
059 <span class="comment">% pp 75--76 and 261--268 </span>
060 <span class="comment">% </span>
061 <span class="comment">% Emanuel Parzen (1962), </span>
062 <span class="comment">% &quot;Stochastic Processes&quot;, HOLDEN-DAY, </span>
063 <span class="comment">% pp 66--103 </span>
064  
065  
066 <span class="comment">% Tested on: Matlab 5.3 </span>
067 <span class="comment">% history: </span>
068 <span class="comment">% Modified by Per A. Brodtkorb 14.08.98,25.05.98 </span>
069 <span class="comment">%  - add a nugget effect to ensure that round off errors </span>
070 <span class="comment">%    do not result in negative spectral estimates </span>
071 <span class="comment">% Modified by svi 29.09.99 </span>
072 <span class="comment">%  - The program is not estimating transformation g any more. </span>
073 <span class="comment">% modified pab 22.10.1999 </span>
074 <span class="comment">%  - fixed so that x in fact can be a m column matrix </span>
075 <span class="comment">%  - updated info put into the spectral structure. </span>
076 <span class="comment">%  - updated help header </span>
077 <span class="comment">% modified pab 03.11.1999 </span>
078 <span class="comment">%  - fixed a bug: line 152 wrong array dim. when m&gt;2 </span>
079 <span class="comment">% modified jr 29.01.2000 </span>
080 <span class="comment">%  - modified from dat2spec, new name: dat2spec2 </span>
081 <span class="comment">%  - lines related to confidence bands removed </span>
082 <span class="comment">%  - call to psd removed </span>
083 <span class="comment">% Revised pab Dec 2003 </span>
084 <span class="comment">% -fixed a bug for wdef and updated helpheader accordingly. </span>
085 <span class="comment">%   </span>
086  
087 nugget=10^-12; 
088  
089 freqtype=<span class="string">'w'</span>; <span class="comment">%options are 'f' and 'w' </span>
090  
091 xx=xn; 
092 istime=1; 
093 [n m]= size(xx); 
094  
095 <span class="keyword">if</span> min(m,n)==1,  
096   xx=[ (1:n)' xx(:)];istime=0; 
097   n=max(m,n); 
098   m=2; 
099 <span class="keyword">end</span> 
100  
101 <span class="keyword">if</span> (nargin &lt; 7) | isempty(chopOffHighFreq), 
102   chopOffHighFreq=0;  
103   <span class="comment">% chop off high frequencies in order to get the same  </span>
104   <span class="comment">% irregularity factor in the spectrum as in the data </span>
105   <span class="comment">% not a good idea </span>
106 <span class="keyword">end</span> 
107  
108 <span class="keyword">if</span> (nargin &lt; 6) | isempty(dT), 
109   dT=xx(2,1)-xx(1,1); 
110   <span class="keyword">if</span> ~istime 
111     disp(<span class="string">' Warning: The sampling frequency is undetermined and set to 1 Hz.'</span>) 
112   <span class="keyword">end</span> 
113 <span class="keyword">end</span> 
114  
115 <span class="keyword">if</span> (nargin &lt; 5) | isempty(wdef) 
116   wdef=1; <span class="comment">% 1=parzen window 2=hanning window </span>
117 <span class="keyword">elseif</span> ischar(wdef) 
118   <span class="keyword">switch</span> lower(wdef(1)) 
119    <span class="keyword">case</span> <span class="string">'p'</span>, 
120     wdef = 1; <span class="comment">% parzen </span>
121    <span class="keyword">case</span> <span class="string">'h'</span>, 
122     wdef = 2; <span class="comment">% hanning </span>
123    <span class="keyword">otherwise</span> 
124     error(<span class="string">'unknown option'</span>) 
125   <span class="keyword">end</span> 
126 <span class="keyword">end</span> 
127  
128 <span class="keyword">if</span> (nargin &lt; 4) | isempty(plotflag) 
129   plotflag = 0;  
130 <span class="keyword">end</span> 
131 <span class="keyword">if</span> (nargout == 0) &amp; (plotflag==0) 
132   plotflag = 1;  
133 <span class="keyword">end</span> 
134  
135 <span class="keyword">if</span> (nargin&lt;3)  
136   g=[]; 
137 <span class="keyword">end</span> 
138  
139 <span class="keyword">if</span>  (isempty(g)),  
140   yy=xx; 
141 <span class="keyword">else</span> 
142   yy = <a href="../../wafo/trgauss/dat2gaus.html" class="code" title=" Transforms  x  using the transformation  g.">dat2gaus</a>(xx,g); 
143 <span class="keyword">end</span> 
144  
145 <span class="comment">% By using a tapered data window to smooth the data at each </span>
146 <span class="comment">% end of the record has the effect of sharpening </span>
147 <span class="comment">% the spectral window. </span>
148 <span class="comment">% NB! the resulting spectral estimate must be  </span>
149 <span class="comment">% normalized in order to correct for the loss of </span>
150 <span class="comment">% amplitude (energy) caused by the data taper. </span>
151 <span class="comment">%taper=bingham(n); </span>
152 <span class="comment">%yy(:,2)=bingham(n).*yy(:,2); </span>
153 <span class="comment">%display('****1'); </span>
154 <span class="comment">%break; </span>
155 yy(:,2:m)=(yy(:,2:m)-ones(n,1)*mean(yy(:,2:m)) );<span class="comment">%/std(yy(:,2)); </span>
156  
157 max_L=300; 
158  
159 changed_L =0; 
160 <span class="keyword">if</span> (nargin &lt; 2 | isempty(L)) 
161   L=min(n-2,ceil(4/3*max_L)); 
162 <span class="comment">%else </span>
163   changed_L =1; 
164 <span class="keyword">end</span> 
165  
166 <span class="comment">%if ~strcmp(method,'psd') | changed_L,  </span>
167   r=0; 
168   stdev=0; 
169   <span class="keyword">for</span> ix=2:m 
170     R=<a href="dat2cov.html" class="code" title=" Estimate auto covariance function from data.">dat2cov</a>(yy(:,[1 ix])); 
171     r=r+R.R(:); 
172     stdev=stdev+R.stdev(:); 
173   <span class="keyword">end</span> 
174   R.stdev=stdev/(m-1); 
175   r=r/(m-1); 
176   R.R=r; 
177   <span class="keyword">if</span>   changed_L, 
178     <span class="comment">% finding where ACF is less than 2 st. deviations. </span>
179     L=find(abs(r(1:max_L))&gt;2*R.stdev(1:max_L))+1; <span class="comment">% a better L value   </span>
180     L=min(L(<span class="keyword">end</span>),max_L); 
181   <span class="keyword">end</span>   
182 <span class="comment">%end </span>
183  
184 <span class="keyword">if</span> wdef==1             <span class="comment">% Parzen window </span>
185   <span class="keyword">if</span> changed_L,        <span class="comment">% modify L so that hanning and Parzen give appr. the same  </span>
186                        <span class="comment">% result </span>
187     L=min(floor(4*L/3),n-2);disp([<span class="string">'The default L is set to '</span> num2str(L) ]) 
188   <span class="keyword">end</span> 
189   v=floor(3.71*n/L);   <span class="comment">% degrees of freedom used in chi^2 distribution </span>
190   win=<a href="../../wafo/onedim/private/parzen.html" class="code" title=" returns the N-point Parzen window in a column vector.">parzen</a>(2*L-1);   <span class="comment">% Does not give negative estimates of the spectral density </span>
191   Be=2*pi*1.33/(L*dT); <span class="comment">% bandwidth (rad/sec) </span>
192    
193 <span class="keyword">elseif</span> wdef==2         <span class="comment">% Hanning window </span>
194   <span class="keyword">if</span> changed_L, 
195     disp([<span class="string">' The default L is set to '</span> num2str(L) ]) 
196   <span class="keyword">end</span> 
197   v=floor(2.67*n/L);   <span class="comment">% degrees of freedom used in chi^2 distribution </span>
198   win=<a href="../../wafo/onedim/private/hanning.html" class="code" title=" returns the N-point Hanning window in a column vector.">hanning</a>(2*L-1);  <span class="comment">% May give negative estimates of the spectral density </span>
199   Be =2*pi/(L*dT);     <span class="comment">% bandwidth (rad/sec) </span>
200 <span class="keyword">end</span> 
201  
202 nf=2^nextpow2(2*L-2);  <span class="comment">%  Interpolate the spectrum with rate = 2 </span>
203 nfft=2*nf; 
204  
205 S=<a href="../../wafo/spec/createspec.html" class="code" title=" Spectrum structure constructor">createspec</a>(<span class="string">'freq'</span>,freqtype); 
206 S.tr=g; 
207 S.note=[<span class="string">'dat2spec('</span>,inputname(1),<span class="string">')'</span>]; 
208 S.L=L; 
209 S.S=zeros(nf+1,m-1); 
210  
211 <span class="comment">% add a nugget effect to ensure that round off errors </span>
212 <span class="comment">% do not result in negative spectral estimates </span>
213  
214 r=r+nugget; 
215 rwin=r(1:L).*win(L:(2*L-1));  
216 Rper=real(fft([rwin; zeros(nfft-(2*L-1),1); rwin(L:-1:2)],nfft)); 
217  
218 rpmin=min(Rper); 
219 <span class="keyword">if</span> rpmin&lt;0 
220   disp(<span class="string">' Warning: negative spectral estimates'</span>) 
221 <span class="keyword">end</span> 
222  
223 <span class="keyword">if</span> strcmp(freqtype,<span class="string">'w'</span>) 
224   S.w=[0:(nf)]'/nf*pi/dT;              <span class="comment">% (rad/s) </span>
225   S.S=abs(Rper(1:(nf+1),1))*dT/pi;     <span class="comment">% (m^2*s/rad) one-sided spectrum </span>
226   S.Bw=Be; 
227 <span class="keyword">else</span> <span class="comment">% freqtype == f </span>
228   S.f=[0:(nf)]'/nf/2/dT;               <span class="comment">% frequency Hz if dT is in seconds </span>
229   S.S=2*abs(Rper(1:(nf+1),1))*dT;      <span class="comment">% (m^2*s) one-sided spectrum </span>
230   S.Bw=Be/(2*pi);                      <span class="comment">% bandwidth in Hz </span>
231 <span class="keyword">end</span> 
232  
233  
234   
235  
236 N=floor(nf/10); 
237 <span class="comment">% cutting off high frequencies  </span>
238 <span class="comment">% in this way may not be a very good idea. </span>
239  
240 <span class="keyword">if</span> (N&gt;3)&amp;chopOffHighFreq,  
241    
242     <span class="comment">% The data must be Gaussian in order for this proc to be correct. </span>
243     [g0 test cmax irr]  = <a href="../../wafo/trgauss/dat2tr.html" class="code" title=" Estimate transformation, g, from data.">dat2tr</a>(xx,<span class="string">'nonlinear'</span>); 
244   ind=(nf-4):(nf+1); 
245   [S,m4,m2]=<a href="../../wafo/spec/wnormspec.html" class="code" title=" Normalize a spectral density such that m0=m2=1">wnormspec</a>(S,0); 
246  
247   <span class="keyword">while</span> (sqrt(m4/m2^2) &gt; irr) &amp; (ind(1)&gt;1)  
248     S.S(ind)=0; 
249     [S,m4,m2]=<a href="../../wafo/spec/wnormspec.html" class="code" title=" Normalize a spectral density such that m0=m2=1">wnormspec</a>(S,0); 
250     ind=ind-5; 
251   <span class="keyword">end</span> 
252   fcut=S.w(min(ind(<span class="keyword">end</span>)+5,nf)); <span class="comment">% cut off frequency </span>
253   <span class="keyword">if</span> ind(1)&lt;1, 
254     disp(<span class="string">'DAT2SPEC: Error in cutting off high frequencies, try other L-values'</span>) 
255   <span class="keyword">end</span> 
256 <span class="keyword">end</span> 
257  
258  
259  
260 <span class="comment">%-----------------------------------  </span>
261 <span class="comment">%  </span>
262 <span class="comment">%     Plotting the Spectral Density  </span>
263 <span class="comment">% </span>
264 <span class="comment">%----------------------------------- </span>
265  
266 <span class="keyword">if</span> plotflag&gt;0 
267  <a href="../../wafo/spec/wspecplot.html" class="code" title=" Plot a spectral density  ">wspecplot</a>(S,plotflag) 
268 <span class="keyword">end</span> 
269  
270</pre></div>
<HR noShade>
<SMALL><A href="http://www.maths.lth.se/matstat/">Mathematical 
Statistics</A><BR><A href="http://www.maths.lth.se/">Centre for Mathematical 
Sciences</A><BR><A href="http://www.lu.se/">Lund University</A> with <A 
href="http://www.lth.se/">Lund Institute of Technology</A> </SMALL>
<P><SMALL>Comments or corrections to the <A
href="mailto:wafo@maths.lth.se">WAFO group</A>  </P>

<hr><address>Generated on Thu 06-Oct-2005 02:21:16
 for <strong><A href="http://www.maths.lth.se/matstat/wafo/">WAFO</A></strong>
 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/">m2html</a></strong> &copy; 2003</address>
</body>
</html>